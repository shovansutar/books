Bad:

select sum(decode(pay_flag||employee_flag,'PAYEMP',1,0)) pay_emp_count, 
               sum(decode(pay_flag||employee_flag,'PAYCWK',1,0)) pay_cwk_count,
               sum(decode(pay_flag||employee_flag,'PAYPWK',1,0)) pay_pwk_count,
               sum(decode(pay_flag||employee_flag,'PAYNONW',1,0)) pay_nonw_count,
               sum(decode(pay_flag||employee_flag,'PAYOFFER',1,0)) pay_offer_count,
               sum(decode(pay_flag||employee_flag,'NOPAYEMP',1,0)) nopay_emp_count, 
               sum(decode(pay_flag||employee_flag,'NOPAYCWK',1,0)) nopay_cwk_count,
               sum(decode(pay_flag||employee_flag,'NOPAYPWK',1,0)) nopay_pwk_count,
               sum(decode(pay_flag||employee_flag,'NOPAYNONW',1,0)) nopay_nonw_count,
               sum(decode(pay_flag||employee_flag,'NOPAYOFFER',1,0)) nopay_offer_count
        from 
        (
            select p.person_id,
            (
                select COALESCE(
                       max(decode(period_type,'E','EMP')),
                       max(decode(period_type,'N','NONW')),
                       max(decode(period_type,'C','CWK')),
                       max(decode(period_type,'P','PWK')),
                       max(decode(period_type,'O','OFFER'))
                       ) worker_type
                from fusion.per_periods_of_service swr  
                where swr.person_id = p.person_id
                and swr.legislation_code = 'US'        
                -- exclude any work relationship which started as well as ended outside of the reporting date range.
                -- This means any work relationship which is active atleast for 1 day in between reporting date range 
                -- will be included in query.
                and not (
                    (nvl(swr.actual_termination_date,to_date('31124712','DDMMYYYY')) < to_date('2019-09-24','yyyy-mm-dd') and swr.date_start < to_date('2019-09-24','yyyy-mm-dd')) 
                    or (nvl(swr.actual_termination_date,to_date('31124712','DDMMYYYY')) > to_date('2020-09-23','yyyy-mm-dd') and swr.date_start > to_date('2020-09-23','yyyy-mm-dd'))
                )
            ) employee_flag,
            (
                SELECT decode(count(1), 0, 'NOPAY','PAY')
                from fusion.pay_pay_relationships_dn rel,
                     fusion.pay_payroll_actions pact,
                     fusion.pay_payroll_rel_actions ract,
                     fusion.pay_action_contexts ctx,
                     fusion.per_legislative_data_groups ldg
                where rel.legislative_data_group_id = ldg.legislative_data_group_id
                and ldg.legislation_code = 'US'
                and ract.payroll_relationship_id = rel.payroll_relationship_id
                and pact.payroll_action_id = ract.payroll_action_id
                and pact.action_type in ('R','Q')                                -- consider Run, QuickPay 
                and ctx.payroll_rel_action_id = ract.payroll_rel_action_id
                and pact.effective_date between to_date('2019-09-24','yyyy-mm-dd') and to_date('2020-09-23','yyyy-mm-dd')
                AND rel.person_id = p.person_id
                AND ctx.calc_breakdown_id is not null
                and rownum = 1
            ) pay_flag
            from fusion.PER_PERSONS p
            where exists
                (select 1 from  
                     fusion.PER_PERSON_ADDR_USAGES_F au,
                     fusion.PER_ADDRESSES_F a
                where p.person_id = au.person_id
                and a.ADDRESS_ID = au.ADDRESS_ID
                and a.country = 'US'
                -- exclude any address which is created as well as end-dated on dates outsided of the reporting date range
                -- This means any address record which falls in between report date range will be included in query. 
                and not 
                    (
                        (a.EFFECTIVE_END_DATE < to_date('2019-09-24','yyyy-mm-dd') and a.EFFECTIVE_START_DATE < to_date('2019-09-24','yyyy-mm-dd')) or
                        (a.EFFECTIVE_END_DATE > to_date('2020-09-23','yyyy-mm-dd') and a.EFFECTIVE_START_DATE > to_date('2020-09-23','yyyy-mm-dd'))
                    )
                )
             -- Check for active workrelship in US
             and exists
                (select 1 
                   from fusion.per_periods_of_service wr
                  where wr.person_id = p.person_id
                    --and wr.period_type = 'E' -- commented to include non-employees
                    and wr.legislation_code = 'US'
                    -- exclude any work relationship which started as well as ended outside of the reporting date range.
                    -- This means any work relationship which is active atleast for 1 day in between reporting date range 
                    -- will be included in query.
                    and not (
                        (nvl(wr.actual_termination_date,to_date('31124712','DDMMYYYY')) < to_date('2019-09-24','yyyy-mm-dd') and wr.date_start < to_date('2019-09-24','yyyy-mm-dd')) 
                        or (nvl(wr.actual_termination_date,to_date('31124712','DDMMYYYY')) > to_date('2020-09-23','yyyy-mm-dd') and wr.date_start > to_date('2020-09-23','yyyy-mm-dd'))
                    )
                )
        )
